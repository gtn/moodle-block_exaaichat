{"version":3,"file":"moodle_settings.min.js","sources":["../src/moodle_settings.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Functions for the moodle settings page\n *\n * @module     block_exaaichat\n * @copyright  2025 GTN Solutions https://gtn-solutions.com\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport {getString} from 'core/str';\n\n/**\n * init function, which is called when the instance form is displayed\n */\nexport function init() {\n  const $select = $('select[name$=\"block_exaaichat_api_type\"]');\n  let $form = $select.closest('form');\n  const oldValue = $select.val();\n\n  $select.on('change', async function () {\n    if (!confirm(await getString('moodle_settings:api_type:change', 'block_exaaichat'))) {\n      // Revert to old value\n      $select.val(oldValue);\n    } else {\n      // submit the form (click the submit button, so all moodle form handlers are called)\n      let submitbutton = $form.find('button[type=\"submit\"]');\n      if (submitbutton.length) {\n        // moodle formular\n        submitbutton[0].click();\n      }\n    }\n  });\n\n  // placeholder fÃ¼r system message\n  $form = $form || $('form#adminsettings');\n  const $addPlaceholderBtn = $form.find(\"#config_add_placeholder_button\");\n  const $placeholderDropdown = $form.find(\"#config_placeholder_dropdown\");\n  // Info: using the name of the field, because the element id iscreated dynamically by moodle\n  const $messageTextarea = $form.find('textarea[name$=\"block_exaaichat_sourceoftruth\"]');\n\n  if ($addPlaceholderBtn.length) {\n    // enable button (was disabled in form config by default)\n    $addPlaceholderBtn.prop('disabled', false);\n    $addPlaceholderBtn.click(async () => {\n      $messageTextarea.val($messageTextarea.val() + ($messageTextarea.val() ? \"\\n\" : \"\") + $placeholderDropdown.val());\n\n      // scroll to bottom of the textarea\n      $messageTextarea[0].scrollTo({\n        top: $messageTextarea[0].scrollHeight,\n        behavior: 'smooth'\n      });\n    });\n  }\n}\n"],"names":["$select","$form","closest","oldValue","val","on","async","confirm","submitbutton","find","length","click","$addPlaceholderBtn","$placeholderDropdown","$messageTextarea","prop","scrollTo","top","scrollHeight","behavior"],"mappings":";;;;;;;4FA8BQA,SAAU,mBAAE,gDACdC,MAAQD,QAAQE,QAAQ,cACtBC,SAAWH,QAAQI,MAEzBJ,QAAQK,GAAG,UAAUC,oBACdC,cAAc,kBAAU,kCAAmC,oBAGzD,KAEDC,aAAeP,MAAMQ,KAAK,yBAC1BD,aAAaE,QAEfF,aAAa,GAAGG,aANlBX,QAAQI,IAAID,aAYhBF,MAAQA,QAAS,mBAAE,4BACbW,mBAAqBX,MAAMQ,KAAK,kCAChCI,qBAAuBZ,MAAMQ,KAAK,gCAElCK,iBAAmBb,MAAMQ,KAAK,mDAEhCG,mBAAmBF,SAErBE,mBAAmBG,KAAK,YAAY,GACpCH,mBAAmBD,OAAML,UACvBQ,iBAAiBV,IAAIU,iBAAiBV,OAASU,iBAAiBV,MAAQ,KAAO,IAAMS,qBAAqBT,OAG1GU,iBAAiB,GAAGE,SAAS,CAC3BC,IAAKH,iBAAiB,GAAGI,aACzBC,SAAU"}